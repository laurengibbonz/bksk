function initEvents(){openCtrl.addEventListener("click",openSearch),closeCtrl.addEventListener("click",closeSearch),document.addEventListener("keyup",function(a){27==a.keyCode&&closeSearch()})}function openSearch(){searchContainer.classList.add("search--open"),inputSearch.focus()}function closeSearch(){searchContainer.classList.remove("search--open"),inputSearch.blur(),inputSearch.value=""}function dynamicSize(){var a=$(document).width();($("body").hasClass("page-template-page-inspiration")||$("body").hasClass("page-template-page-instagram"))&&(a>=1200?$(".item").removeClass("fourcol twocol").addClass("fivecol"):a<1200&&a>=768?$(".item").removeClass("fivecol twocol").addClass("fourcol"):a<767&&a>=490&&$(".item").removeClass("fivecol fourcol").addClass("twocol"),w>320&&menu.is(":hidden")&&menu.removeAttr("style"))}function getHashFilter(){var a=location.hash.match(/filter=([^&]+)/i),b=a&&a[1];return console.log(b),b&&decodeURIComponent(b)}function onHashchange(){var a=getHashFilter();null!=a&&(isIsotopeInit=!0,$grid.isotope({percentPosition:!0,columnWidth:".grid-sizer",itemSelector:".grid-item",filter:"."+a,layoutMode:"packery",packery:{gutter:".gutter-sizer"}}),a&&($filters.find(".active").removeClass("active"),$filters.find('[data-filter="'+a+'"]').addClass("active")))}function initOverlay(a){$(".overlay").addClass("open"),$(".overlay").removeClass("partner emeritus staff"),"partner"==a||"emeritus"==a?$(".overlay").addClass("partner"):$(".overlay").addClass("staff")}function overlay(a,b){if("partner"==b)var c=$('[data-slide-partner-id="'+a+'"]');else if("emeritus"==b)var c=$('[data-slide-emeritus-id="'+a+'"]');else var c=$('[data-slide-id="'+a+'"]');var d,e,f=$(c).find("a").data("type"),g=$(c).data("id"),h=$(c).find("a").data("name"),i=$(c).find("a").data("title"),j=$(c).find("a").data("credentials"),k=$(c).find("a").data("bio"),l=$(c).find("a").data("largesrc"),m=$(c).find("a").data("resume"),n=$(c).find("a").data("link");totalSlides="staff"==f?$(".grid-item--staff").length:"emeritus"==f?$('.grid-item--partner a[data-type="emeritus"]').length:$('.grid-item--partner a[data-type="partner"]').length,1==totalSlides?$("button.prev, button.next").hide():$("button.prev, button.next").show(),d=""==m?"":'<a target="_blank" href="'+m+'">Resume</a>',e=""==j?"":'class="comma"',"partner"!=f&&"emeritus"!=f||partnerSub(g,n),$(".overlay .content").html('<div class="left"><header><img class="header-img" src="'+l+'" /><div class="header__text"><h2><span '+e+">"+h+'</span> <span class="small">'+j+"</span></h2><h3>"+i+"</h3></div></header><article>"+k+d+'</article></div><div class="right"><img src="'+l+'" /></div><div class="sub"></div>')}function partnerSub(a,b){$.ajax({type:"POST",url:"/overlay-team.php",data:{id:a},success:function(a){$(".sub").append(a)}})}function replaceMentions(a){return a.replace(/@([a-z\d_]+)/gi,'<a href="http://twitter.com/$1">@$1</a>')}function replaceHash(a){return a.replace(/#([a-zA-Z0-9]+)/g,'<a href="http://twitter.com/hashtag/$1">#$1</a>')}function initMap(){var a={lat:40.743371,lng:-73.990508},b=new google.maps.Map(document.getElementById("map__office"),{zoom:15,styles:[{featureType:"administrative",elementType:"all",stylers:[{saturation:"-100"}]},{featureType:"administrative.province",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{saturation:-100},{lightness:65},{visibility:"on"}]},{featureType:"poi",elementType:"all",stylers:[{saturation:-100},{lightness:"50"},{visibility:"simplified"}]},{featureType:"road",elementType:"all",stylers:[{saturation:"-100"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"all",stylers:[{lightness:"30"}]},{featureType:"road.local",elementType:"all",stylers:[{lightness:"40"}]},{featureType:"transit",elementType:"all",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"water",elementType:"geometry",stylers:[{hue:"#ffff00"},{lightness:-25},{saturation:-97}]},{featureType:"water",elementType:"labels",stylers:[{lightness:-25},{saturation:-100}]},{featureType:"poi",stylers:[{visibility:"off"}]}],center:a});new google.maps.Marker({position:a,map:b})}function setMaxWidth(){$("#slides img").css("maxWidth",(.9*$(window).width()|0)+"px")}function loadItems(a){return $("a#inifiniteLoader").show("fast"),$.ajax({url:"../wp-admin/admin-ajax.php",type:"POST",data:"action=infinite_scroll&page_no="+a+"&loop_file=loop-work.php",success:function(a){var b=$(a);$grid.append(b),$grid.imagesLoaded(function(){$.each(b,function(){$(this).removeClass("hidden")}),$grid.isotope("appended",b)})}}),!1}function activeClass(a){$this=a,$($this).is(":checked")?$($this).parents("a").addClass("selected"):$($this).parents("a").removeClass("selected")}function getComboFilter(a){$(".grid-item").removeClass("grid-item--featured");var b=0,c=[],d=[];for(var e in a){d.push(a[e].join(""));var f=a[e];if(f.length){if(0===b)c=f.slice(0);else{for(var g=[],h=c.slice(0),i=0,j=f.length;i<j;i++)for(var k=0,l=h.length;k<l;k++)g.push(h[k]+f[i]);c=g}b++}}addFeatured(c);var m=c.join(", "),n=m.replace(/\s/g,"");return window.location.hash=n,m}function addFeatured(a){var b=a.map(function(a){return".featured_"+(a=a.replace(".",""))}),b=b.join(",");$(b).addClass("grid-item--featured")}function manageCheckbox(a){console.log(filters);var b=a[0],c=a.parents(".group").attr("data-group"),d=filters[c];d||(console.log("new group"),filters={},$checkboxes.removeAttr("checked"),filterDisplay(b,c),d=filters[c]=[],b.checked||(b.checked="checked"));var e=a.hasClass("all");e&&(delete filters[c],b.checked||(b.checked="checked"));var f=$.inArray(b.value,d);if(b.checked){var g=e?"input":"input.all";a.siblings(g).removeAttr("checked"),e||-1!==f||filters[c].push(b.value)}else e||(filters[c].splice(f,1),a.siblings("[checked]").length||a.siblings("input.all").attr("checked","checked"))}function filterDisplay(a,b){$this=a;$(a).parents("a");console.log(b),$checkboxes.filter(":checked").each(function(){$checkboxes.removeAttr("checked")}),$(a).attr("checked","checked"),"discipline-interiors"!=b&&"interiors"!=b||($($this).not(":checked")&&$(".discipline-interiors input").prop("checked",!0),$(".filter.interiors").is(":hidden")&&($(".filter").fadeOut(),$(".filter.interiors").delay(400).fadeIn()),$(".img--interiors").css("z-index",1),toggleLink("interiors")),"discipline-architecture"==b&&($(".discipline-architecture input").prop("checked",!0),$(".filter").fadeOut(),$(".filter.architecture").delay(400).fadeIn(),$(".img--interiors").css("z-index",-1),toggleLink()),"specialty-preservation"==b&&($(".discipline-architecture input").prop("checked",!0),$(".filter--three").fadeOut(),$(".filter--three.preservation").delay(400).fadeIn(),toggleLink()),"preservation"==b&&($(".discipline-architecture input").prop("checked",!0),$(".specialty-preservation input").prop("checked",!0),toggleLink()),"architecture"==b&&($(".discipline-architecture input").prop("checked",!0),toggleLink()),"specialty-sustainability"==b&&($(".discipline-architecture input").prop("checked",!0),$(".filter--three").fadeOut(),toggleLink())}function toggleLink(a){$(".grid-item a").each(function(){var b=$(this).attr("href");b=b.split("?")[0],"interiors"==a?$(this).attr("href",b+"?order=interiors"):$(this).attr("href",b)})}function reset(a){$(".featured_default").addClass("grid-item--featured"),$(".quicksearch").val(""),buttonFilter="",qsRegex="",window.location.hash="",filters={},$grid.isotope(),0==a?$(".filters a").find(":input").prop("checked",!1):$("#filters a").find(":input").prop("checked",!1),$(".filter--two,.filter--three").fadeOut()}function debounce(a,b){var c;return function(){function d(){a(),c=null}c&&clearTimeout(c),setTimeout(d,b||100)}}$(".toplink").click(function(a){return a.preventDefault(),$("html, body").animate({scrollTop:0},600),!1});var openCtrl=document.getElementById("btn-search"),closeCtrl=document.getElementById("btn-search-close"),searchContainer=document.querySelector(".overlay-search"),inputSearch=searchContainer.querySelector(".search__input");$(document).ready(function(){dynamicSize(),initEvents()}),$(window).resize(function(){($("body").hasClass("page-template-page-inspiration")||$("body").hasClass("page-template-page-instagram"))&&dynamicSize(),$(window).width()>490&&menu.is(":hidden")&&menu.removeAttr("style")});var pull=$("#pull");if(menu=$(".menu-navigation-container ul"),menuHeight=menu.height(),$(pull).on("click",function(a){a.preventDefault(),menu.slideToggle()}),$("body").hasClass("home")){var $grid=$(".grid");$grid.imagesLoaded(function(){$(".grid").isotope({percentPosition:!0,columnWidth:".grid-sizer",itemSelector:".item",layoutMode:"packery",packery:{gutter:".gutter-sizer"}}),$("#main, footer").animate({opacity:1},600)})}else if($("body").hasClass("post-type-archive-lab")){var $grid=$(".grid-lab");$grid.imagesLoaded(function(){$grid.isotope({percentPosition:!0,columnWidth:".grid-sizer",itemSelector:".grid-item",layoutMode:"packery",packery:{gutter:".gutter-sizer"}}),$(".grid-lab").animate({opacity:1})});var $filters=$(".filter");$filters.on("click","a",function(a){a.preventDefault(),$(this).toggleClass("active");var b=$(this).attr("data-filter");console.log("filter: "+b),location.hash="filter="+encodeURIComponent(b)});var isIsotopeInit=!1;$(window).on("hashchange",onHashchange),onHashchange()}else if($(".content").hasClass("grid-team")){var $grid=$(".grid-team");$grid.imagesLoaded(function(){$grid.isotope({percentPosition:!0,itemSelector:".grid-item",columnWidth:".grid-sizer",layoutMode:"packery",filter:filterSelector,packery:{gutter:".gutter-sizer"}}),$(".grid-team").animate({opacity:1})});var slideID;$(".grid-item--partner").on("click",function(){"emeritus"==$(this).find("a").data("type")?(slideID=$(this).data("slide-emeritus-id"),slideType="emeritus"):(slideID=$(this).data("slide-partner-id"),slideType="partner"),initOverlay(slideType),overlay(slideID,slideType)}),$(".grid-item--staff").on("click",function(){slideID=$(this).data("slide-id"),initOverlay("staff"),overlay(slideID,"staff")}),$(".close").on("click",function(){$(".overlay").removeClass("open")}),$(".prev, .next").click(function(){return $(this).hasClass("next")?slideID!=totalSlides?slideID++:slideID=1:1!=slideID?slideID--:slideID=totalSlides,$(".overlay").hasClass("partner")?slideType="partner":slideType="staff",overlay(slideID,slideType),!1}),$(".grid-item--staff").hover(function(){$(this).removeClass("bw")},function(){$(this).addClass("bw")})}else if($("body").hasClass("page-template-page-recognition")||$("body").hasClass("page-id-5361")||$("body").hasClass("tag")||$("body").hasClass("single-post")||$("body").hasClass("search")){var headers=$(".accordion-header"),contentAreas=$(".accordion-content").hide(),expandLink=$(".accordion-expand-all");headers.click(function(){var a=$(this).find(".arrow"),b=$(this).next(),c=b.is(":visible");return b[c?"slideUp":"slideDown"]().trigger(c?"hide":"show"),a.toggleClass("open"),!1}),expandLink.click(function(){var a=$(this).data("isAllOpen");contentAreas[a?"hide":"show"]().trigger(a?"hide":"show")}),contentAreas.on({show:function(){!contentAreas.is(":hidden")&&expandLink.text("Collapse All").data("isAllOpen",!0)},hide:function(){!contentAreas.is(":hidden")||expandLink.text("Expand all").data("isAllOpen",!1)}});var user="bkskarchitects";$.ajax({url:"/twitterproxy.php?url="+encodeURIComponent("statuses/user_timeline.json?screen_name="+user+"&count=4"),type:"GET",success:function(a){var b=[];for(i in a){console.log(a);var c=a[i],d=c.text;d=d.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,function(a){return'<a href="'+a+'">'+a+"</a>"}).replace(/B@([_a-z0-9]+)/gi,function(a){return a.charAt(0)+'<a href="http://twitter.com/'+a.substring(1)+'">'+a.substring(1)+"</a>"}),d=replaceMentions(d),d=replaceHash(d);var e=c.created_at,f=e.split(" "),g=f[1]+" "+f[2];name=c.user.screen_name;var h='<span class="gray"><a href="http://twitter.com/'+name+'" target="_blank">@'+name+"</a> - "+g+"</span><p>"+d+"</p>";b.push(h);b.join("");$(".twitter").html(b)}},error:function(a){console.log(a)}})}else if($("body").hasClass("page-id-2"))$(".map--toggle").click(function(){$(".map").fadeOut(),$(".map--toggle").removeClass("active"),$(this).addClass("active");var a=$(this).attr("data-show");$("#map__"+a).fadeIn(),$("#map__"+a).animate({opacity:1})});else if($("body").hasClass("single-work"))$(document).on("ready",function(){setMaxWidth(),$("#slides").imagesLoaded(function(){$(".loading-wrapper").fadeOut(function(){$("#slides").animate({opacity:1})})}),$("#slides").slick({centerMode:!0,centerPadding:"0",slidesToShow:1,variableWidth:!0,draggable:!0,responsive:[{breakpoint:768,settings:{arrows:!1,centerPadding:"0"}}]}),$(".slick-slide").click(function(){var a=$("#slides").slick("slickCurrentSlide"),b=$(this).data("slick-index");console.log(b),console.log(a),b>a?$("#slides").slick("slickNext"):b<a&&$("#slides").slick("slickPrev")})}),$(window).bind("resize",setMaxWidth);else if($("body").hasClass("post-type-archive-work")){var $grid=$("#grid"),init=!0,pageNumber=3,maxPages=3,all,buttonFilter,filters={},$checkboxes=$("#filters input"),filterSelector=window.location.hash.slice(1);$grid.imagesLoaded(function(){0==$(".grid-item--featured").length&&$(".featured_default").addClass("grid-item--featured"),$grid.isotope(),$(".loading-wrapper").fadeOut(),$(".grid-work").delay(100).animate({opacity:1})}),$grid.isotope({percentPosition:!0,columnWidth:".grid-sizer",itemSelector:".grid-item",layoutMode:"packery",filter:function(){var a=$(this),b=!qsRegex||a.find("h3").text().match(qsRegex),c=!buttonFilter||a.is(buttonFilter);return b&&c},packery:{gutter:".gutter-sizer"},getSortData:{category:"[data-category]",name:".text"},sortBy:"category"});var isotope=$grid.data("isotope");if($("#filters").on("change",function(a){manageCheckbox($(a.target));var b=getComboFilter(filters);buttonFilter=b,$grid.isotope()}),$(".filter--remove").on("click",function(){all=!0,reset(all)}),filterSelector){var selectorClasses=filterSelector.split(".");$.each(selectorClasses,function(a,b){b=b.replace(",",""),$('#filters input[value=".'+b+'"]').delay(500*a).click()})}var qsRegex,buttonFilter,$quicksearch=$(".quicksearch").keyup(debounce(function(a){qsRegex=new RegExp($quicksearch.val(),"gi"),$grid.isotope()},200));$(".quicksearch").submit(function(){return!1}),$grid.on("arrangeComplete",function(a,b){b.length<=0?$("#empty").fadeIn():$("#empty").hide()})}